<!DOCTYPE html>
<html>

<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    
    <title>蚊香的博客</title>
    <link rel="stylesheet" type="text/css" href="/static/css/semantic.min.css">
    <style type="text/css">
        @font-face {
            font-family: 'myHan';
            src: URL('/static/fonts/HYGuoQiangXingShuW-1.ttf') format('truetype');
        }
        
        .han {
            font-weight: normal;
            font-family: "myHan";
        }
        
        .postContent h1 {
            font-size: 1.5em;
        }
        
        .postContent h2 {
            font-size: 1.25em;
        }
        
        .postContent h3 {
            font-size: 1em;
        }
        
        .hidden.menu {
            display: none;
        }
        
        .masthead.segment {
            min-height: 200px;
            padding: 1em 0em;
        }
        
        .masthead .logo.item img {
            margin-right: 1em;
        }
        
        .masthead .ui.menu .ui.button {
            margin-left: 0.5em;
        }
        
        .masthead h1.ui.header {
            margin-top: 1em;
            margin-bottom: 0em;
            font-size: 2.33em;
        }
        
        .masthead h2 {
            font-size: 1.7em;
        }
        
        .ui.vertical.stripe {
            padding: 8em 0em;
        }
        
        .ui.vertical.stripe h3 {
            font-size: 2em;
        }
        
        .ui.vertical.stripe .button+h3,
        .ui.vertical.stripe p+h3 {
            margin-top: 3em;
        }
        
        .ui.vertical.stripe .floated.image {
            clear: both;
        }
        
        .ui.vertical.stripe p {
            font-size: 1.33em;
        }
        
        .ui.vertical.stripe .horizontal.divider {
            margin: 3em 0em;
        }
        
        .quote.stripe.segment {
            padding: 0em;
        }
        
        .quote.stripe.segment .grid .column {
            padding-top: 5em;
            padding-bottom: 5em;
        }
        
        .footer.segment {
            padding: 5em 0em;
        }
        
        .secondary.pointing.menu .toc.item {
            display: none;
        }
        
        @media only screen and (max-width: 700px) {
            .ui.fixed.menu {
                display: none !important;
            }
            .secondary.pointing.menu .item,
            .secondary.pointing.menu .menu {
                display: none;
            }
            .secondary.pointing.menu .toc.item {
                display: block;
            }
            .masthead.segment {
                min-height: 350px;
            }
            .masthead h1.ui.header {
                font-size: 2em;
                margin-top: 1.5em;
            }
            .masthead h2 {
                margin-top: 0.5em;
                font-size: 1.5em;
            }
        }
    </style>

    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/semantic.js"></script>
    <script>
        $(document)
            .ready(function() {

                
                $('.masthead')
                    .visibility({
                        once: false,
                        onBottomPassed: function() {
                            $('.fixed.menu').transition('fade in');
                        },
                        onBottomPassedReverse: function() {
                            $('.fixed.menu').transition('fade out');
                        }
                    });

                
                $('.ui.sidebar')
                    .sidebar('attach events', '.toc.item');

            });
    </script>
</head>

<body>

    
    <div class="ui large top fixed hidden menu">
        <div class="ui container nav">
            <a class="active item" href="/">首页</a></a>
            <a class="item">Category</a>
            <a class="item">标签</a>
            <a class="item">About</a>
            <div class="right item">
                <div class="ui animated fade button" tabindex="0">
                    <div class="visible content">赋此间一抹丹砂</div>
                    <div class="hidden content"><a href="">回到顶端</a></div>
                </div>
            </div>
        </div>
    </div>

    
    <div class="ui vertical inverted sidebar menu">
        <a class="active item" href="/">首页</a>
        <a class="item">归档</a>
        <a class="item">标签</a>
        <a class="item">关于</a>
    </div>


    
    <div class="pusher">
        <div class="ui inverted vertical masthead center aligned segment">

            <div class="ui container">
                <div class="ui large secondary inverted pointing menu">
                    <a class="toc item">
                        <i class="sidebar icon"></i>
                    </a>
                    <div class="left item">
                        <a class="ui inverted button" href="/">清 | 狂</a>
                    </div>
                    <div class="right item">
                        <a class="active item" href="/">Home</a>
                        <a class="item">分类</a>
                        <a class="item">Tags</a>
                        <a class="item">关于我</a>

                    </div>
                </div>
            </div>

            <div class="ui text container">
                <h1 class="ui inverted header">
                    <span class="han">
                    不知道为什么，就是要写一句话放这里!
                    </span>
                </h1>
                <h2 class="han">Do whatever you want when you want to.</h2>
            </div>

        </div>

        <div class="ui vertical stripe segment">
            <div class="ui text container">
                
                <h3 class="ui header"><a href="/2017/07/04/%28%e7%bf%bb%e8%af%91%29writing%20a%20Static%20Blog%20Generator%20in%20Go">(翻译)writing a Static Blog Generator in Go</a></h3>
                <div class="postContent">
                    <hr />

<p>翻译原文：<a href="https://zupzup.org/static-blog-generator-go/?utm_source=golangweekly&amp;utm_medium=emai">https://zupzup.org/static-blog-generator-go/?utm_source=golangweekly&amp;utm_medium=emai</a></p>

<h1>Writing a Static Blog Generator in Go 使用Go写一个静态博客生成器</h1>

<p>A static-site-generator is a tool which, given some input (e.g. markdown) generates a fully static website using HTML, CSS and JavaScript.</p>

<p>一个静态网站生成器是一个使用HTML, CSS and JavaScript,将给予的输入文件（例如markdown）生成完整的静态网站</p>

<p>Why is this cool? Well, for one it’s a lot easier to host a static site and it’s also (usually) quite a bit faster and resource-friendly. Static sites aren’t the best choice for all use-cases, but for mostly non-interactive websites such as blogs they are great.</p>

<p>为什么这很Cool？是的，对于一个人来说，主持一个静态的网站要容易得多，而且(通常)也会更快，而且资源更友好。静态网站不是对所有情况都是最好的选择，但是对于大多数非交互网站比如博客，是非常好的。</p>

<p>In this post, I will describe the static blog generator I wrote in Go, which powers this blog.</p>

<p>在本文中，我将描述我使用Go编写的静态博客生成器，它为这个博客提供了强大的功能。</p>

                </div>
                <a class="ui large button" href="/2017/07/04/%28%e7%bf%bb%e8%af%91%29writing%20a%20Static%20Blog%20Generator%20in%20Go">Read More</a>
                <h4 class="ui horizontal header divider">
                    <a href="#">这是分界线哦~~</a>
                </h4>
                
                <h3 class="ui header"><a href="/2017/06/28/%28%e7%bf%bb%e8%af%91%29%e5%8f%96%e6%b6%88%e5%a4%9a%e4%b8%aaGoroutines">(翻译)取消多个Goroutines</a></h3>
                <div class="postContent">
                    <hr />

<p>原文 <a href="https://chilts.org/2017/06/12/cancelling-multiple-goroutines">https://chilts.org/2017/06/12/cancelling-multiple-goroutines</a></p>

<h1>Cancelling Multiple Goroutines 取消多协程</h1>

<p>When Go was first released, there was a way to do some things in concurrency. As time has gone on, various things have changed. The Context package for one thing. :)</p>

<p>在Go刚开始发行的时候，只有一种并发的方法。随着时间流逝，很多事情都发生了变化。Context包就是其中之一。</p>

<p>This article doesn’t go into all of the ways of doing concurrency but will focus on one problem and take you through a few different solutions so you can see how things have evolved.</p>

<p>这篇文章不会探究所有并发的方法，但是会研究一个问题，并带你熟悉一些不同的解决方法，让你了解方法是如何推论出来的。</p>

<h2>The Problem</h2>

<p>The problem I’d like to address here is being able to cancel multiple goroutines. There are many blog posts out there (I curate @CuratedGo, please follow) which show how to cancel just one goroutine, but my use-case was slightly more complicated. The rest of this article summarises my progress through getting this to work.</p>

<p>我在这里想提出的问题是取消对协程。有许多blog写了如何取消一个协程，但是我的用例是更加复杂的。下面的文章总结了我实现的过程。</p>

<p>The way we’re going decide when to quit is by listening for a C-c keypress. Of course at that point, we want to make sure we tidy up things nicely at that point. For example, if we’re currently streaming tweets from Twitter, we’d rather we told them we’re finished than just drop the connection.</p>

<p>我们要决定何时退出的方式是监听C-c按键。当然，我们确保我们在这一点上很好地处理事情。例如，如果我们目前正在推送Twitter的推文，我们要告诉他们我们已经完成，而不是放弃了解。</p>

<p>Let’s get started.
让我们开始吧</p>

                </div>
                <a class="ui large button" href="/2017/06/28/%28%e7%bf%bb%e8%af%91%29%e5%8f%96%e6%b6%88%e5%a4%9a%e4%b8%aaGoroutines">Read More</a>
                <h4 class="ui horizontal header divider">
                    <a href="#">这是分界线哦~~</a>
                </h4>
                
                <h3 class="ui header"><a href="/2017/06/28/lec01%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0">lec01学习笔记</a></h3>
                <div class="postContent">
                    <hr />

<p>分为: 存储，通讯和计算
关键点：实现，性能，容错和一致性。一致性和性能不可兼得
split-brain的意思是A true split brain means multiple systems are online and have accessed an exclusive resource simultaneously</p>

<p>MapReduce： 定义Map和Reduce函数，输入数组形式的数据。</p>

<p>扩展：不互相等待，不共享数据。可并发执行。可单纯的配置更多的计算机来获得更多的吞吐量
性能：Hard to build a network than can run 1000x faster than a single computer.So they cared about minimizing movement of data over the network.一般会被网络限制。尽量减少数据在网络上传输。
容错：当Map和Reduce失败时，重新运行。他们仅仅是函数而已&ndash;他们不修改输入的内容，不用保存状态，不共享内存，没有Map-Map和Reduce-Reduce的交互。所以重新执行会得到相同的输出。纯函数（pure function）的这个需求是相对于其他并行编程方案的主要限制，也是MR简单的原因。</p>

<p>MapReduce由Mater和Worker组成。Master给workers分配工作，决定worker运行map方法还是reduce方法。当worker执行错误，直接重启worker就好。
master的调度程序</p>

                </div>
                <a class="ui large button" href="/2017/06/28/lec01%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0">Read More</a>
                <h4 class="ui horizontal header divider">
                    <a href="#">这是分界线哦~~</a>
                </h4>
                
                <h3 class="ui header"><a href="/2017/06/21/%e4%bd%bf%e7%94%a8%e7%bd%91%e9%a1%b5%e6%89%93%e5%bc%80%e6%9c%ac%e5%9c%b0%e7%a8%8b%e5%ba%8f">使用网页打开本地程序</a></h3>
                <div class="postContent">
                    <hr />

<p>浏览器中使用window.open()打开URL。当URL为特定的前缀的时候（URI Scheme），就会调用注册表中对应的指令。</p>

<h2>写入注册表</h2>

<p>参考 <a href="https://msdn.microsoft.com/en-us/library/aa767914(VS.85).aspx">https://msdn.microsoft.com/en-us/library/aa767914(VS.85).aspx</a>
其中的关键是在注册表中写入如下的注册表项</p>

<pre><code>HKEY_CLASSES_ROOT
   alert
      (Default) = &quot;URL:Alert Protocol&quot;
      URL Protocol = &quot;&quot;
      DefaultIcon
         (Default) = &quot;alert.exe,1&quot;
      shell
         open
            command
               (Default) = &quot;C:\Program Files\Alert\alert.exe&quot; &quot;%1
</code></pre>

<p>使用go操作注册表.path为程序的地址。uri为调用程序的URI Scheme。
使用js调用window.open(&ldquo;uri://&ldquo;)就可以打开程序。</p>

<pre><code class="language-go">func regKey(path string,uri string) error {
	vconsoleKey, ok, err := registry.CreateKey(registry.CLASSES_ROOT, uri, registry.CREATE_SUB_KEY|registry.SET_VALUE)
	if err != nil {
		logger.Printf(&quot;CreateKey console err :%v\n&quot;, err)
		return err
	}
	if ok {
		return err
	}
	defer vconsoleKey.Close()
	vconsoleKey.SetStringValue(&quot;URL Protocol&quot;, &quot;&quot;)
	vconsoleKey.SetStringValue(&quot;DefaultIcon&quot;, path)
	shellKey, _, err := registry.CreateKey(vconsoleKey, `shell`, registry.CREATE_SUB_KEY)
	if err != nil {
		logger.Printf(&quot;CreateKey shell err :%v\n&quot;, err)
		return err
	}
	openKey, _, err := registry.CreateKey(shellKey, `open`, registry.CREATE_SUB_KEY)
	if err != nil {
		logger.Printf(&quot;CreateKey open err :%v\n&quot;, err)
		return err
	}
	commandKey, _, err := registry.CreateKey(openKey, `command`, registry.CREATE_SUB_KEY|registry.SET_VALUE)
	if err != nil {
		logger.Printf(&quot;CreateKey err :%v\n&quot;, err)
		return err
	}
	commandKey.SetStringValue(&quot;&quot;, path)

	return nil
}
</code></pre>

<h2>获取管理员权限</h2>

<p>在注册表中写入注册表项需要管理员权限。
- go get github.com/akavel/rsrc
- 把nac.manifest文件拷贝到当前windows项目根目录
- rsrc -manifest nac.manifest -o nac.syso
- go build</p>

<p>nac.mainfest的内容为：</p>

<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;assembly xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot; manifestVersion=&quot;1.0&quot;&gt;
&lt;trustInfo xmlns=&quot;urn:schemas-microsoft-com:asm.v3&quot;&gt;
&lt;security&gt;
&lt;requestedPrivileges&gt;
&lt;requestedExecutionLevel level=&quot;requireAdministrator&quot;/&gt;
&lt;/requestedPrivileges&gt;
&lt;/security&gt;
&lt;/trustInfo&gt;
&lt;/assembly&gt;
</code></pre>

                </div>
                <a class="ui large button" href="/2017/06/21/%e4%bd%bf%e7%94%a8%e7%bd%91%e9%a1%b5%e6%89%93%e5%bc%80%e6%9c%ac%e5%9c%b0%e7%a8%8b%e5%ba%8f">Read More</a>
                <h4 class="ui horizontal header divider">
                    <a href="#">这是分界线哦~~</a>
                </h4>
                
                <h3 class="ui header"><a href="/2016/12/26/%ef%bc%88%e7%bf%bb%e8%af%91%ef%bc%89BitTorrent-Protocol%e5%8d%8f%e8%ae%ae%e8%a7%84%e8%8c%83">（翻译）BitTorrent-Protocol协议规范</a></h3>
                <div class="postContent">
                    <hr />

<p>本文翻译原文：<a href="http://www.bittorrent.org/beps/bep_0003.html">http://www.bittorrent.org/beps/bep_0003.html</a>
BitTorrent是一个分发文件的协议。它通过URL识别内容，旨在与网络无缝集成。它和一般的HTTP相比的优势在于，当同一个文件的多个下载同时发生时，下载者相互上传，使得文件源可以支持非常大量下载，而其负载增加很小。</p>

<h2>BitTorrent文件分发有这些部分组成：</h2>

<ul>
<li>一个普通的web服务器</li>
<li>静态“元信息（metainfo）”文件</li>
<li>BitTorrent跟踪器（tracker）</li>
<li>“原始”下载器</li>
<li>用户web浏览器端</li>
<li>用户下载器端</li>
</ul>

<p>理想情况下多端用户现在同一个文件</p>

<h2>要开始服务，主机将执行以下步骤</h2>

<ol>
<li>开启一个跟踪器（tracker）</li>
<li>开启一个普通的web服务器，例如Apache</li>
<li>在他们的Web服务器上，将扩展名.torrent与mimetype应用程序/ x-bittorrent相关联。</li>
<li>使用提供的完整的文件和跟踪器URL，生成一个元数据（metainfo）的(.torrent) 文件</li>
<li>将元信息(.torrent)文件放在web服务器上</li>
<li>链接来自其它网页的(.torrent)元数据文件</li>
</ol>

                </div>
                <a class="ui large button" href="/2016/12/26/%ef%bc%88%e7%bf%bb%e8%af%91%ef%bc%89BitTorrent-Protocol%e5%8d%8f%e8%ae%ae%e8%a7%84%e8%8c%83">Read More</a>
                <h4 class="ui horizontal header divider">
                    <a href="#">这是分界线哦~~</a>
                </h4>
                
                <div class="ui large buttons">
                    <button class="ui button"  disabled><a href="/">上一页</a></button>
                    <div class="or"></div>
                    <button class="ui button" ><a href="/page/2">下一页</a></button>
                </div>
            </div>
        </div>


        <div class="ui inverted vertical footer segment">
            <div class="ui container">
                <div class="ui stackable inverted divided equal height stackable grid">
                    <div class="three wide column">
                    </div>
                </div>
            </div>
        </div>
    </div>


</body>

</html>